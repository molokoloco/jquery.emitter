<!--// Remixed by @molokoloco 2011 - http://b2bweb.fr //-->
<!DOCTYPE html> 
<html> 
<head> 
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="content-language" content="fr"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=720" />
    <title>Emitter particules factory with jQuery & CSS3 V0.4</title>
    <link rel="stylesheet" type="text/css" href="jquery.emitter.css">
    <script src="modernizr.min.js" type="text/javascript"></script>
</head>
<body>
    <div id="page">
        <div class="legend">
           CSS3 sprites transition factory with jQuery
        </div>
        
        <div id="emitterZone1">
            <!--// Here come the Sprites //-->
        </div>
        
        <div class="legend">
            <div style="float:right;"><a href="javascript:void(0);" id="start">Start</a> | 
            <a href="javascript:void(0);" id="pause">Pause</a></div>Live edit plugin funny emitter properties !
        </div>
        
        <div id="edit">
            <!--// Here come the Editor (demo) //-->
        </div>
        
         <div class="legend tips">
             <strong>Tips :</strong> Up/Down arrow to inc numbers values in editable JSON string<br />
             Add your properties, set unwanted existing ones to "null" (live editor constrain)<br />
             transition : 'all 3000ms linear' is more fast than 'cubic-bezier()'<br />
             gradient, boxShadow, opacity, borderRadius are CPU consumming<br />
             Questions or cool configs to share ? <a href="mailto:molokoloco@gmail.com" id="pause">Contact me</a><br />
             <a href="https://github.com/molokoloco/jquery.emitter" target="_blank">Fork it</a> and get updated on GitHub
        </div>
       
        <a href="https://github.com/molokoloco/jquery.emitter" target="_blank" title="Fork me on GitHub" class="ribbon">
            <img src="http://www.b2bweb.fr/bonus/jx/images/github-ribbon.png" alt="GitHub" width="100" height="100">
        </a>
    </div>
    
    <!-- jQuery + Emitter Plugin : ".min" for minimified version -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
    <script src="jquery.emitter.mlklc.js" type="text/javascript"></script>
    <!-- For the demo : easy incrementation of values in a textarea editor -->
    <script src="incrementable.leaverou.js" type="text/javascript"></script>
    
    <script type="text/javascript">

$(function() { // PAGE DOM READY
    
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Particules Emitter factory plugin with jQuery & CSS3 
    // V0.6 - @molokoloco 2011 - http://b2bweb.fr
    // Check $.fn.emitter.options for more infos
    // Be sure to choose border, background, etc if you want to see something
    // Infos : http://www.b2bweb.fr/molokoloco/emitter-sprites-particules-factory-with-jquery-css3/
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    
    // Some options presets...
    var optionsPresets = {};
    
    optionsPresets.molecules = { // EXAMPLE #1
        // EMITTER TYPE
        effect            : 'nebula',    // 'nebula' or 'artifice'    // Add your custom effect !
        transition        : 'all 3000ms cubic-bezier(.2, .1, .9, 0)', // CSS Animation
        newAtTop          : 'random',    // Last element appear in top of others : 'random' OR bolean
        rate              : 0,           // New sprite every ms, Set to 0 for the plugin to use requestFrame (as fast as possible)
        maxSprite         : 100,         // Max sprites at one moment (Each sprite is a new DOM element)
        emitterRadius     : 16,          // 10, '10px' or '50%' // Radius of emitter
        emitterCenterLeft : '50%',       // 10, '10px' or '50%' // Default to the center of the box
        emitterCenterTop  : '50%',
        // SPRITES HTML & CSS
        element           : '<div class="sprite"></div>',             // Default sprite is a div
        cssFrom           : {            // Properties managed with plugin Effect : marginTop, marginLeft, top, left, z-index
                                         // Other CSS properties allowed, plugin add the correct browser-prefix if needed
            width             : 8,       // '10', '10px' or '50%'     // Radius of a sprite
            height            : null,
            maxSize           : 16,      // Custom plugin propertie, randomize size between width and maxSize ?
            transform         : null,    // 'rotate(180deg) scale(5) translateX(10px, 0px) skew(-10deg,10deg)',
            backgroundColor   : null,    // 'rgba(255, 255, 0, 1)',
            backgroundImage   : '-'+$.getBrowser+'-radial-gradient(33% 33%, circle cover,rgba(230,230,250,1) 25%,rgba(50,50,70,1) 80%)', // 'url()' or '-moz-radial-gradient()'
            maskImage         : null,    // gradient, color, ...
            boxShadow         : '0 0 10px rgba(0,0,0,1)',
            border            : null,    // '1px dashed rgb(0,0,0)', // buggus with alpha
            borderRadius      : '50%',   // '10px' or '50%' // Default round with half size radius
            opacity           : 1
        },
        cssTo             : {            // All the "cssFrom" properties are usable
            width             : 20,
            height            : null,
            maxSize           : '60%',   // Ex. 60% >> random width between 20px and 60% of the box size
            borderRadius      : '50%',   // Round
            opacity           : 1
        }
    }; // Default
    
    
    
    // optionsPresets are used like a JSON "Editable" object... (Textarea)
    
    optionsPresets.html5Ize = {
        "effect": "nebula",
        "transition": "all 2000ms linear",
        "newAtTop": true,
        "rate": 0,
        "maxSprite": 250,
        "emitterRadius": 150,
        "emitterCenterLeft": "50%",
        "emitterCenterTop": "50%",
        "element": "<img src=\"http://www.w3.org/html/logo/downloads/HTML5_Badge_32.png\" width=\"32\" heigh=\"32\"/>",
        "position": "absolute",
        "cssFrom": {
            "width": 32,
            "height": 32,
            "borderRadius": 0
        },
        "cssTo": {
            "opacity": 0
        }
    };
    
    optionsPresets.acidSquares = {
        "effect": "artifice",
        "transition": "all 2600ms linear",
        "newAtTop": true,
        "rate": 0,
        "maxSprite": 200,
        "emitterRadius": "100%",
        "emitterCenterLeft": "50%",
        "emitterCenterTop": "50%",
        "cssFrom": {
            "width": 200,
            "height": 200,
            "transform": "rotate(45deg)",
            "backgroundColor": "rgba(195,216,37,0.1)",
            "border": "1px solid yellow",
            "borderRadius": 0
        },
        "cssTo": {
            "opacity": 0
        }
    };
    
    optionsPresets.hyperSpace = {
        "effect": "nebula",
        "transition": "all 600ms linear",
        "newAtTop": true,
        "rate": 0,
        "maxSprite": 500,
        "emitterRadius": 5,
        "emitterCenterLeft": "50%",
        "emitterCenterTop": "75%",
        "cssFrom": {
            "width": 1,
            "backgroundColor": "yellow",
            "borderRadius": 0
        },
        "cssTo": {}
    };
    
    optionsPresets.deepSun = {
        "effect": "artifice",
        "transition": "all 4000ms ease-in-out",
        "newAtTop": "random",
        "rate": 500,
        "maxSprite": 16,
        "emitterRadius": 50,
        "emitterCenterLeft": "50%",
        "emitterCenterTop": "50%",
        "cssFrom": {
            "width": 200,
            "maxSize": 250,
            "backgroundImage": "-"+$.getBrowser+"-radial-gradient(40% 40%, circle cover,rgba(230,240,163,0) 0%, rgba(210,230,56,1) 90%, rgba(195,216,37,0) 100%)",
            "boxShadow": "0 0 30px rgba(219,240,67,1)",
            "borderRadius": "50%"
        },
        "cssTo": {
            "width": 600,
            "borderRadius": 600,
            "opacity": 0
        }
    };
    
    optionsPresets.whiteHole = {
        "effect": "",
        "transition": "all 1500ms ease-in-out",
        "newAtTop": "random",
        "rate": 0,
        "maxSprite": 60,
        "emitterRadius": 20,
        "emitterCenterLeft": "50%",
        "emitterCenterTop": "50%",
        "cssFrom": {
            "width": 150,
            "height": 150,
            "maxSize": 200,
            "backgroundColor": "#FFFFFF",
            "backgroundImage": null,
            "boxShadow": "0 0 30px #FFFFFF",
            "borderRadius": "50%",
            "opacity": 1
        },
        "cssTo": {
            "width": 150,
            "height": 150,
            "maxSize": 250,
            "borderRadius": 600,
            "opacity": 1
        }
    };
    
    optionsPresets.rainbowArrow = {
        "effect": "artifice",
        "transition": "all 7000ms cubic-bezier(1, 1, 0, 0)",
        "newAtTop": "random",
        "rate": 500,
        "maxSprite": 16,
        "emitterRadius": 60,
        "emitterCenterLeft": "50%",
        "emitterCenterTop": "120%",
        "cssFrom": {
            "width": 50,
            "height": 100,
            "backgroundColor": "rgba(219,20,80,1)",
            "boxShadow": "0 0 50px rgba(219,20,80,1)",
            "borderRadius": 1000
        },
        "cssTo": {
            "width": 1,
            "height": 500,
            "borderRadius": 1000,
            "backgroundColor": "rgba(255,255,5,1)",
            "boxShadow": "0 0 50px rgba(255,255,5,1)",
            "opacity": 0
        }
    };
        
    optionsPresets.lolCat = {
        "effect": "nebula",
        "transition": "all 4000ms linear",
        "newAtTop": true,
        "rate": 900,
        "maxSprite": 14,
        "emitterRadius": 50,
        "emitterCenterLeft": "0",
        "emitterCenterTop": "10%",
        "element": "<img src=\"http://www.b2bweb.fr/bonus/nian-cat.png\" width=\"772\" heigh=\"93\"/>",
        "position": "absolute",
        "cssFrom": {
            "width": 772,
            "height": 93,
            "transform": "scale(0.1) skew(-10deg,10deg)",
            "borderRadius": 0
        },
        "cssTo": {
            "transform": "scaleY(2) scaleX(2.5) skew(10deg,-10deg)",
            "opacity": 0
        }
    };
    
    optionsPresets.typoGraphe = {
        "effect": "artifice",
        "transition": "all 2500ms ease-out",
        "newAtTop": true,
        "rate": 180,
        "maxSprite": 22,
        "emitterRadius": 20,
        "emitterCenterLeft": "50%",
        "emitterCenterTop": "90%",
        "element": "<span>dO yOu dOO ?</span>",
        "position": "absolute",
        "cssFrom": {
            "width": 600,
            "height": 120,
            "transform": "scale(0.33)",
            "font": "60px Trebuchet,Verdana",
            "color": "rgb(200,0,150)",
            "text-shadow": "2px 1px 2px rgba(255,255,255,0.5)",
            "borderRadius": 0
        },
        "cssTo": {
            "color": "rgb(200,10,80)",
            "text-shadow": "2px 1px 6px rgba(255,255,255,0.5)",
            "transform": "scale(1)",
            "alpha": 1
        }
    };
    
    
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // OK create our emitter factory
    var $emitter1 = $('div#emitterZone1').emitter(optionsPresets.molecules);
    
    // Links for controlling emitter
    $('a#start,a#pause').click(function() {
        $emitter1.trigger(this.id); // start || pause || stop
    });
    
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Catch new Sprite emit event and display stats (only for the demo)
    // Inspired from https://github.com/mrdoob/stats.js
    var now = Date.now(),
        T = {frames:0, time:now, timeLastSecond:now, fps:0},
        $stat = $('<span id="sps" title="Sprites/Seconds"></span>').appendTo($emitter1);
    
    // Bind our emittor, don't need element so comment
    $emitter1.bind('emit', function(/* e, $sprite */) { 
        T.time = Date.now();
        T.frames ++;
        if (T.time > T.timeLastSecond + 1000) {
            T.fps = Math.round((T.frames * 1000) / (T.time - T.timeLastSecond));
            $('span#sps').html(T.fps+'s/sec');
            T.timeLastSecond = T.time;
            T.frames = 0;
        }
    });
    
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Ex. Move the emitterCenter, when mouse is over
    var offset = $emitter1.offset(),
        mouseIsMove = function(evt) {
            $emitter1.trigger('update', [{ // Pass data through event callback
                emitterCenterLeft : evt.pageX - offset.left,
                emitterCenterTop : evt.pageY - offset.top
            }]);
        },
        mouseIsEnter = function(evt) {
            $emitter1.bind('mousemove', mouseIsMove);
        },
        mouseIsLeave = function(evt) {
            $emitter1.unbind('mousemove', mouseIsMove);
            $emitter1.trigger('update', [{ // Reset
                emitterCenterLeft : parseInt($emitter1.width(), 10) / 2,
                emitterCenterTop : parseInt($emitter1.height(), 10) / 2
            }]);
        };
    
    $emitter1.bind({
        mouseenter:mouseIsEnter,
        mouseleave:mouseIsLeave
    });
    
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // EMITTER LIVE EDITOR (only for the demo) ////////////////////////////////////////////////////////
    // JSON.parse - http://jsfiddle.net/molokoloco/rSMLU/
    
    var getQ = function(o) { return (o && typeof o == 'string' ? '\'' : ''); }, // Get Quotes '
        obj2Json = function(_options) { // Convert "options" js Object to string
            var txt = '';  
            if (JSON !== 'undefined') txt = JSON.stringify(_options, null, 4);
            else {
                for (var k in _options) { // don't catch key:null as sub-obj
                    if (typeof _options[k] == 'object' && _options[k] !== null) { // Level 2 array ?
                        txt += '\t'+k+': {\n';
                        for (var j in _options[k])
                            txt += '\t\t'+j+': '+getQ(_options[k][j])+_options[k][j]+getQ(_options[k][j])+',\n';
                        txt = txt.substr(0, txt.length - 2)+'\n';
                        txt += '\t},\n';
                    }
                    else txt += '\t'+k+': '+getQ(_options[k])+_options[k]+getQ(_options[k])+',\n';
                }
                txt = '{\n'+txt.substr(0, txt.length - 2)+'\n}';
            }
            return txt;
        },
        textareaUpdateEmitter = function(event) {
            var liveOptions = null,
                val = $.trim($(this).val());
            if (!val) return;
            try {
                if (JSON !== 'undefined') liveOptions = JSON.parse(val);
                else eval('liveOptions = '+val+';');
            }
            catch(e) { db('Parsing error', e); }
            if (liveOptions) $emitter1.trigger('update', [liveOptions]);
        },
        buttonsClickSetOptions = function(event) {
            event.preventDefault();
            if (optionsPresets[this.id]) {
                $editor.val(obj2Json(optionsPresets[this.id]));
                $emitter1.trigger('setOptions', [optionsPresets[this.id]]);
            }
            return false;
        };

    // Append Editor with options as text
    $editor = $('<textarea id="options" spellcheck="false">'+
                    obj2Json(optionsPresets.molecules)+
                '</textarea>')
        .bind('keyup', textareaUpdateEmitter)
        .appendTo('div#edit');
    
    // Create buttons for all our PRESETS 
    var btnHtml = [], n = 0;
    for(var k in optionsPresets) {
        btnHtml.push('<a id="'+k+'" href="javascript:void(0);">'+k+'</a>');
        n++;
    }
    $('<div class="tips">Effect presets : '+btnHtml.join(', ')+'</div><br />').prependTo('div#edit');
    $('body').delegate('div#edit a', 'click', buttonsClickSetOptions);
    
    if (window.Incrementable) new Incrementable($editor.get(0)); // Incrementable plugin
});
</script>


</body>
</html>