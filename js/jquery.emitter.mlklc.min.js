/*
    // V0.7 - Particules Emitter factory plugin with jQuery & CSS3 
    // MIT License - @molokoloco 28/10/2011 - http://b2bweb.fr
    // Infos      : http://goo.gl/P18db
	// Plain demo : http://www.b2bweb.fr/framework/jquery.emitter/jquery.emitter.html
    // Cloud9ide  : http://cloud9ide.com/molokoloco/jquery_emitter
    // Live demo  : http://jsfiddle.net/molokoloco/aqfsC/
    // Sources    : https://github.com/molokoloco/jquery.emitter
	// Download   : http://www.b2bweb.fr/framework/jquery.emitter/jquery.emitter.zip
*/

var db=function(){"console"in window&&console.log.call(console,arguments)};
(function(b,c){c.requestAnimFrame=function(){return c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||c.msRequestAnimationFrame||function(a){c.setTimeout(a,1E3/60)}}();b.getRand=function(a,b){return parseInt(a+Math.random()*(b-a),10)};b.getSize=function(a,b){a&&/\%/.test(a)&&(a=parseFloat(a)/100*b);return parseFloat(a)};b.cubicBeziers={bounce:"cubic-bezier(0.000,0.350,0.500,1.300)",easeInQuad:"cubic-bezier(0.550,0.085,0.680,0.530)",easeInCubic:"cubic-bezier(0.550,0.055,0.675,0.190)",
easeInQuart:"cubic-bezier(0.895,0.030,0.685,0.220)",easeInQuint:"cubic-bezier(0.755,0.050,0.855,0.060)",easeInSine:"cubic-bezier(0.470,0.000,0.745,0.715)",easeInExpo:"cubic-bezier(0.950,0.050,0.795,0.035)",easeInCirc:"cubic-bezier(0.600,0.040,0.980,0.335)",easeOutQuad:"cubic-bezier(0.250,0.460,0.450,0.940)",easeOutCubic:"cubic-bezier(0.215,0.610,0.355,1.000)",easeOutQuart:"cubic-bezier(0.165,0.840,0.440,1.000)",easeOutQuint:"cubic-bezier(0.230,1.000,0.320,1.000)",easeOutSine:"cubic-bezier(0.390,0.575,0.565,1.000)",
easeOutExpo:"cubic-bezier(0.190,1.000,0.220,1.000)",easeOutCirc:"cubic-bezier(0.075,0.820,0.165,1.000)",easeInOutQuad:"cubic-bezier(0.455,0.030,0.515,0.955)",easeInOutCubic:"cubic-bezier(0.645,0.045,0.355,1.000)",easeInOutQuart:"cubic-bezier(0.770,0.000,0.175,1.000)",easeInOutQuint:"cubic-bezier(0.860,0.000,0.070,1.000)",easeInOutSine:"cubic-bezier(0.445,0.050,0.550,0.950)",easeInOutExpo:"cubic-bezier(1.000,0.000,0.000,1.000)",easeInOutCirc:"cubic-bezier(0.785,0.135,0.150,0.860)"};b.browserPrefix=
function(){var a=navigator.userAgent.toLowerCase(),b={firefox:"moz",applewebkit:"webkit",webkit:"webkit",opera:"o",msie:"ms"},c;for(c in b)if(a.indexOf(c)!==-1)return b[c];return false}();b.transitionEnd={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"msTransitionEnd",transition:"transitionEnd"}[Modernizr.prefixed("transition")];b.fn.crossCss=function(a){return this.each(function(){var c=b(this);if(typeof a!="object")return c;for(var j in a)Modernizr.prefixed(j)&&
(a[Modernizr.prefixed(j)]=a[j]);return c.css(a)})};b.fn.emitter=function(a){typeof Modernizr!="object"&&alert('$.fn.emitter require "modernizr(.min).js"');a=b.extend(true,{},b.fn.emitter.options,a);return this.each(function(){var k=b(this),j,s,f,i,l,g,d,e,m,n,o,p;j=true;s=null;f="emitter"+Date.now();c[f]=[];var h={start:function(){setTimeout(function(){q.fixDefaultSizes();j=true;h.newSprite()},0)},newSprite:function(){t()},stop:function(){j=false;s&&clearTimeout(s);s=null},reset:function(){h.stop();
for(var a in c[f])c[f][a]&&c[f][a].length>0&&c[f][a].empty().remove(),delete c[f][a];c[f]=[]},update:function(c,r){a=b.extend(true,{},a,r);q.fixDefaultSizes()},setOptions:function(c,r){h.reset();a=b.extend(true,{},b.fn.emitter.options,r);h.start()}},q={fixDefaultSizes:function(){i=parseInt(k.width(),10);l=parseInt(k.height(),10);if(!a.cssFrom.width&&a.cssFrom.width!==0)db("Config. error, need at least options.cssFrom.width to be setted"),a.cssFrom.width=a.cssFrom.height=0;a.emitterCenterLeft=!a.emitterCenterLeft&&
a.emitterCenterLeft!==0?i/2:b.getSize(a.emitterCenterLeft,i);a.emitterCenterTop=!a.emitterCenterTop&&a.emitterCenterTop!==0?l/2:b.getSize(a.emitterCenterTop,l);if(a.emitterRadius)a.emitterRadius=b.getSize(a.emitterRadius,i);if(a.cssFrom.width)a.cssFrom.width=b.getSize(a.cssFrom.width,i);if(a.cssFrom.height)a.cssFrom.height=b.getSize(a.cssFrom.height,l);if(a.cssFrom.maxSize)a.cssFrom.maxSize=b.getSize(a.cssFrom.maxSize,i);if(a.cssTo.width)a.cssTo.width=b.getSize(a.cssTo.width,i);if(a.cssTo.height)a.cssTo.height=
b.getSize(a.cssTo.height,l);if(a.cssTo.maxSize)a.cssTo.maxSize=b.getSize(a.cssTo.maxSize,i)},getCssStart:function(){var c,r,d,e;c=a.cssFrom.maxSize||a.cssFrom.maxSize===0?b.getRand(a.cssFrom.width,a.cssFrom.maxSize):a.cssFrom.width;r=a.cssFrom.height||a.cssFrom.height===0?a.cssFrom.maxSize||a.cssFrom.maxSize===0?b.getRand(a.cssFrom.height,a.cssFrom.maxSize):a.cssFrom.height:c;d=c/2;e=a.newAtTop=="random"?b.getRand(a.zIndex,a.zIndex+a.maxSprite):a.newAtTop?a.zIndex++:a.zIndex--;b.getRand(-a.emitterRadius,
a.emitterRadius);b.getRand(-a.emitterRadius,a.emitterRadius);return b.extend({},a.cssFrom,{position:a.position,display:a.display||"",zIndex:e,width:c+"px",height:r+"px",borderRadius:a.cssFrom.borderRadius||a.cssFrom.borderRadius===0?a.cssFrom.borderRadius:d+"px"})},getCssEnd:function(c){var d=parseInt(c.width,10),c=parseInt(c.height,10),e;if(a.cssTo.width||a.cssTo.width===0)d=a.cssTo.maxSize||a.cssTo.maxSize===0?b.getRand(a.cssTo.width,a.cssTo.maxSize):a.cssTo.width,e=d/2+"px",c=d;if(a.cssTo.height||
a.cssTo.height===0)c=a.cssTo.maxSize||a.cssTo.maxSize===0?b.getRand(a.cssTo.height,a.cssTo.maxSize):a.cssTo.height;e=a.cssTo.borderRadius||a.cssTo.borderRadius===0?a.cssTo.borderRadius:e;return b.extend({},a.cssTo,{transition:a.transition,width:d+"px",height:c+"px",borderRadius:e})},applyCssStart:function(b,d,e){c[b][d].crossCss(e);a.classStart&&c[b][d].addClass(a.classStart)},applyCssEnd:function(d,e,f){c[d][e]&&(a.classStart&&a.classStop&&c[d][e].removeClass(a.classStart).addClass(a.classStop),
c[d][e].crossCss(f),a.transition&&c[d][e].bind(b.transitionEnd,function(){c[d][e]&&(c[d][e].unbind(b.transitionEnd),c[d][e].attr("style","display:none;"),a.classStart&&c[d][e].removeClass(a.classStart),a.classStop&&c[d][e].removeClass(a.classStop),b.data(c[d][e],"animated",0))}))}},t=function(){if(j){g=-1;for(var h=0;h<a.maxSprite;h++)if(!c[f][h]||!b.data(c[f][h],"animated")){g=h;break}if(g>=0){d=q.getCssStart();e=q.getCssEnd(d);switch(a.effect){case "artifice":d.left=a.emitterCenterLeft+"px";d.top=
a.emitterCenterTop+"px";d.marginLeft=-(parseInt(d.width,10)/2)+b.getRand(-a.emitterRadius,a.emitterRadius);d.marginTop=-(parseInt(d.height,10)/2)+b.getRand(-a.emitterRadius,a.emitterRadius);m=-a.emitterCenterLeft;n=-a.emitterCenterTop;o=i-a.emitterCenterLeft-parseInt(e.width,10);p=l-a.emitterCenterTop-parseInt(e.height,10);Math.random()>0.5?(e.marginLeft=b.getRand(m,o),e.marginTop=Math.random()<0.5?n:p):(e.marginLeft=Math.random()<0.5?m:o,e.marginTop=b.getRand(n,p));break;case "nebula":d.left=a.emitterCenterLeft+
"px";d.top=a.emitterCenterTop+"px";d.marginLeft=-(parseInt(d.width,10)/2)+b.getRand(-a.emitterRadius,a.emitterRadius);d.marginTop=-(parseInt(d.height,10)/2)+b.getRand(-a.emitterRadius,a.emitterRadius);m=-a.emitterCenterLeft-parseInt(e.width,10);n=-a.emitterCenterTop-parseInt(e.height,10);o=i-a.emitterCenterLeft;p=l-a.emitterCenterTop;Math.random()>0.5?(e.marginLeft=b.getRand(m,o),e.marginTop=Math.random()<0.5?n:p):(e.marginLeft=Math.random()<0.5?m:o,e.marginTop=b.getRand(n,p));break;case "center":d.left=
a.emitterCenterLeft+"px",d.top=a.emitterCenterTop+"px",d.marginLeft=-(parseInt(d.width,10)/2)+b.getRand(-a.emitterRadius,a.emitterRadius),d.marginTop=-(parseInt(d.height,10)/2)+b.getRand(-a.emitterRadius,a.emitterRadius),e.marginLeft=-parseInt(e.width,10)/2,e.marginTop=-parseInt(e.height,10)/2}if(!c[f][g]||c[f][g].length<1)c[f][g]=b(a.element).appendTo(k);b.data(c[f][g],"animated",1);q.applyCssStart(f,g,d);setTimeout(q.applyCssEnd,0,f,g,e);k.trigger("emit",[c[f][g]])}g=void 0;d=void 0;e=void 0;m=
void 0;n=void 0;o=void 0;p=void 0;a.delay?s=setTimeout(t,a.delay):c.requestAnimFrame(t)}};k.bind(h);k.trigger("start");return k})};b.fn.emitter.options={effect:"nebula",transition:"all 1000ms linear",newAtTop:"random",emitterRadius:0,emitterCenterLeft:null,emitterCenterTop:null,delay:null,maxSprite:30,element:"<div></div>",position:"absolute",display:null,zIndex:500,classStart:null,classStop:null,convertCss2Class:false,cssFrom:{width:"10%",maxSize:null},cssTo:{}}})(jQuery,window);