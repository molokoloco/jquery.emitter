/*
    // Emitter sprites factory with jQuery & CSS3 V0.4
    // by molokoloco@gmail.com 17/10/2011
    // Infos : http://www.b2bweb.fr/molokoloco/blobby-sprites-factory-with-jquery-css3-v0-1/
	// Live demo V0.4 : http://jsfiddle.net/molokoloco/hDMKg/
	// Sources : https://github.com/molokoloco/jquery.emitter
*/

var db=function(){"console"in window&&console.log.call(console,arguments)};
(function(b,e){e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(a){e.setTimeout(a,1E3/60)}}();b.getRand=function(a,b){return parseInt(a+Math.random()*(b-a),10)};b.getSize=function(a,b){a&&/\%/.test(a)&&(a=parseInt(a,10)/100*b);return parseInt(a,10)};b.cssPrefixString={};b.cssPrefix=function(a){if(b.cssPrefixString[a]||b.cssPrefixString[a]==="")return b.cssPrefixString[a]+
a;var f=document.createElement("div"),c=",Moz,Webkit,O,ms,Khtml".split(","),g;for(g in c)if(typeof f.style[c[g]+a]!=="undefined")return b.cssPrefixString[a]=c[g],c[g]+a;return false};b.getBrowser=function(){var a=navigator.userAgent.toLowerCase(),b={firefox:"Moz",applewebkit:"Webkit",webkit:"Webkit",opera:"O",msie:"ms",Konqueror:"Khtml"},c;for(c in b)if(a.indexOf(c)!==-1)return b[c];return false}();b.fn.crossCss=function(a){return this.each(function(){var e=b(this);if(typeof a!="object")return e;
if(a.transition)a[b.cssPrefix("Transition")]=a.transition;if(a.borderRadius||a.borderRadius===0)a[b.cssPrefix("borderRadius")]=a.borderRadius;if(a.backgroundImage)a[b.cssPrefix("backgroundImage")]=a.backgroundImage;if(a.transform)a[b.cssPrefix("Transform")]=a.transform;if(a.boxShadow)a[b.cssPrefix("boxShadow")]=a.boxShadow;return e.css(a)})};b.fn.emitter=function(a){for(var f in a)typeof a[f]=="object"&&b.fn.emitter.options[f]&&(a[f]=b.extend({},b.fn.emitter.options[f],a[f]));a=b.extend({},b.fn.emitter.options,
a);return this.each(function(){var c=b(this),g,f,l,m,k,d,h,j,n,w,x,y,i,z,o,p,q,r,s,t,u,v;g=parseInt(c.width());f=parseInt(c.height());l=1E3;m=true;k=null;e.numSprites=0;var B=function(){a.transition&&(l=a.transition.split("ms")[0].split(" ")[1]);a.emitterCenterLeft=!a.emitterCenterLeft&&a.emitterCenterLeft!==0?g/2:b.getSize(a.emitterCenterLeft,g);a.emitterCenterTop=!a.emitterCenterTop&&a.emitterCenterTop!==0?f/2:b.getSize(a.emitterCenterTop,f);if(a.emitterRadius)a.emitterRadius=b.getSize(a.emitterRadius,
g);if(a.cssFrom.width)a.cssFrom.width=b.getSize(a.cssFrom.width,g);if(a.cssFrom.height)a.cssFrom.height=b.getSize(a.cssFrom.height,f);if(a.cssFrom.maxSize)a.cssFrom.maxSize=b.getSize(a.cssFrom.maxSize,g);if(a.cssTo.width)a.cssTo.width=b.getSize(a.cssTo.width,g);if(a.cssTo.height)a.cssTo.height=b.getSize(a.cssTo.height,f);if(a.cssTo.maxSize)a.cssTo.maxSize=b.getSize(a.cssTo.maxSize,g)};B();var A=function(){if(e.numSprites<a.maxSprite){d=a.cssFrom.maxSize||a.cssFrom.maxSize===0?b.getRand(a.cssFrom.width,
a.cssFrom.maxSize):a.cssFrom.width;h=a.cssFrom.maxSize||a.cssFrom.maxSize===0?d:a.cssFrom.height?a.cssFrom.height:a.cssFrom.width;j=d/2;n=h/2;w=a.newAtTop=="random"?b.getRand(a.zIndex,a.zIndex+a.maxSprite):a.newAtTop?a.zIndex++:a.zIndex--;x=-j+b.getRand(-a.emitterRadius,a.emitterRadius);y=-n+b.getRand(-a.emitterRadius,a.emitterRadius);i=a.cssFrom.borderRadius||a.cssFrom.borderRadius===0?a.cssFrom.borderRadius:j+"px";z=b.extend({},a.cssFrom,{position:a.position,transition:a.transition,zIndex:w,left:a.emitterCenterLeft+
"px",top:a.emitterCenterTop+"px",marginLeft:x+"px",marginTop:y+"px",width:d+"px",height:h+"px",borderRadius:i});switch(a.effect){case "nebula":if(a.cssTo.width||a.cssTo.width===0)d=a.cssTo.maxSize||a.cssTo.maxSize===0?b.getRand(a.cssTo.width,a.cssTo.maxSize):a.cssTo.width,j=d/2,i=j+"px",h=d;if(a.cssTo.height||a.cssTo.height===0)h=a.cssTo.maxSize||a.cssTo.maxSize===0?d:a.cssTo.height?a.cssTo.height:a.cssTo.width,n=h/2;i=a.cssTo.borderRadius||a.cssTo.borderRadius===0?a.cssTo.borderRadius:i;o=-a.emitterCenterLeft-
d;p=-a.emitterCenterTop-h;q=g-a.emitterCenterLeft;r=f-a.emitterCenterTop;Math.random()>0.5?(s=b.getRand(o,q),t=Math.random()<0.5?p:r):(s=Math.random()<0.5?o:q,t=b.getRand(p,r));u=b.extend({},a.cssTo,{width:d+"px",height:h+"px",borderRadius:i,marginLeft:s+"px",marginTop:t+"px"});break;default:u=b.extend({},a.cssTo)}v=b(a.element).crossCss(z).appendTo(c);e.numSprites++;c.trigger("emit",[v]);setTimeout(function(a,b){a.crossCss(b);setTimeout(function(a){a.remove();e.numSprites--},l,a)},0,v,u)}d=void 0;
h=void 0;j=void 0;n=void 0;w=void 0;x=void 0;y=void 0;i=void 0;z=void 0;o=void 0;p=void 0;q=void 0;r=void 0;s=void 0;t=void 0;u=void 0;v=void 0;a.rate?k=setTimeout(A,a.rate):m&&e.requestAnimFrame(A)};c.bind({start:function(){m=true;A()},stop:function(){m=false;k&&(clearTimeout(k),k=null)},update:function(e,d){g=parseInt(c.width());f=parseInt(c.height());d.transition&&(l=a.transition.split("ms")[0].split(" ")[1]);for(var h in d)typeof d[h]=="object"&&b.fn.emitter.options[h]&&(d[h]=b.extend({},a[h],
d[h]));a=b.extend(a,d);B()}});c.trigger("start");return c})};b.fn.emitter.options={effect:"nebula",transition:"all 1000ms linear",newAtTop:"random",emitterRadius:0,emitterCenterLeft:null,emitterCenterTop:null,rate:null,maxSprite:30,element:"<div></div>",position:"absolute",zIndex:500,cssFrom:{width:"10%",maxSize:null},cssTo:{}}})(jQuery,window);