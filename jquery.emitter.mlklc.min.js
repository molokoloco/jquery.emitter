/*
    // V0.6 - Particules Emitter factory plugin with jQuery & CSS3 
    // MIT License - @molokoloco 28/10/2011 - http://b2bweb.fr
    // Infos      : http://goo.gl/P18db
	// Plain demo : http://www.b2bweb.fr/framework/jquery.emitter/jquery.emitter.html
    // Cloud9ide  : http://cloud9ide.com/molokoloco/jquery_emitter
    // Live demo  : http://jsfiddle.net/molokoloco/aqfsC/
    // Sources    : https://github.com/molokoloco/jquery.emitter
	// Download   : http://www.b2bweb.fr/framework/jquery.emitter/jquery.emitter.zip
*/

var db=function(){"console"in window&&console.log.call(console,arguments)};
(function(c,b){b.requestAnimFrame=function(){return b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(a){b.setTimeout(a,1E3/60)}}();c.getRand=function(a,c){return parseInt(a+Math.random()*(c-a),10)};c.getSize=function(a,c){a&&/\%/.test(a)&&(a=parseInt(a,10)/100*c);return parseInt(a,10)};c.getBrowser=function(){var a=navigator.userAgent.toLowerCase(),c={firefox:"Moz",applewebkit:"Webkit",webkit:"Webkit",
opera:"O",msie:"ms",Konqueror:"Khtml"},b;for(b in c)if(a.indexOf(b)!==-1)return c[b];return false}();c.fn.crossCss=function(a){return this.each(function(){var b=c(this);if(typeof a!="object")return b;for(var d in a)a[Modernizr.prefixed(d)]=a[d];return b.css(a)})};c.fn.emitter=function(a){typeof Modernizr!="object"&&alert('$.fn.emitter require "modernizr(.min).js"');a=c.extend(true,{},c.fn.emitter.options,a);return this.each(function(){var i=c(this),d,r,o,h,g,j,f,s,e,k,l,m,n;d="emitter"+Date.now();
r=true;o=null;h={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"msTransitionEnd",transition:"transitionEnd"};h=h[Modernizr.prefixed("transition")];b[d]=[];var q={start:function(){p.fixDefaultSizes();r=true;t()},pause:function(){r=false;o&&clearTimeout(o);o=null},newSprite:function(){q.stop();t()},stop:function(){q.pause();for(var a in b[d])b[d][a]&&b[d][a].length>0&&b[d][a].empty().remove(),delete b[d][a];b[d]=[]},update:function(b,
d){a=c.extend(true,{},a,d);p.fixDefaultSizes()},setOptions:function(b,d){q.stop();a=c.extend(true,{},c.fn.emitter.options,d);q.start()}},p={fixDefaultSizes:function(){g=parseInt(i.width(),10);j=parseInt(i.height(),10);a.emitterCenterLeft=!a.emitterCenterLeft&&a.emitterCenterLeft!==0?g/2:c.getSize(a.emitterCenterLeft,g);a.emitterCenterTop=!a.emitterCenterTop&&a.emitterCenterTop!==0?j/2:c.getSize(a.emitterCenterTop,j);if(a.emitterRadius)a.emitterRadius=c.getSize(a.emitterRadius,g);if(a.cssFrom.width)a.cssFrom.width=
c.getSize(a.cssFrom.width,g);if(a.cssFrom.height)a.cssFrom.height=c.getSize(a.cssFrom.height,j);if(a.cssFrom.maxSize)a.cssFrom.maxSize=c.getSize(a.cssFrom.maxSize,g);if(a.cssTo.width)a.cssTo.width=c.getSize(a.cssTo.width,g);if(a.cssTo.height)a.cssTo.height=c.getSize(a.cssTo.height,j);if(a.cssTo.maxSize)a.cssTo.maxSize=c.getSize(a.cssTo.maxSize,g)},getCssStart:function(){var b,d,e,f,g,i;(b=a.cssFrom.maxSize||a.cssFrom.maxSize===0?c.getRand(a.cssFrom.width,a.cssFrom.maxSize):a.cssFrom.width)||alert('Config. error, need at least "width" to be setted');
d=a.cssFrom.height||a.cssFrom.height===0?a.cssFrom.maxSize||a.cssFrom.maxSize===0?c.getRand(a.cssFrom.height,a.cssFrom.maxSize):a.cssFrom.height:b;e=b/2;f=d/2;g=a.newAtTop=="random"?c.getRand(a.zIndex,a.zIndex+a.maxSprite):a.newAtTop?null:a.zIndex--;i=-e+c.getRand(-a.emitterRadius,a.emitterRadius);f=-f+c.getRand(-a.emitterRadius,a.emitterRadius);return c.extend({},a.cssFrom,{position:a.position,display:a.display,zIndex:g,left:a.emitterCenterLeft+"px",top:a.emitterCenterTop+"px",marginLeft:i+"px",
marginTop:f+"px",width:b+"px",height:d+"px",borderRadius:a.cssFrom.borderRadius||a.cssFrom.borderRadius===0?a.cssFrom.borderRadius:e+"px"})},getCssEnd:function(b){var d=parseInt(b.width,10),b=parseInt(b.height,10),e;if(a.cssTo.width||a.cssTo.width===0)d=a.cssTo.maxSize||a.cssTo.maxSize===0?c.getRand(a.cssTo.width,a.cssTo.maxSize):a.cssTo.width,e=d/2+"px",b=d;if(a.cssTo.height||a.cssTo.height===0)b=a.cssTo.maxSize||a.cssTo.maxSize===0?c.getRand(a.cssTo.height,a.cssTo.maxSize):a.cssTo.height;e=a.cssTo.borderRadius||
a.cssTo.borderRadius===0?a.cssTo.borderRadius:e;return c.extend({},a.cssTo,{transition:a.transition,width:d+"px",height:b+"px",borderRadius:e})},applyCssEnd:function(a,d,e){b[a][d]&&(b[a][d].crossCss(e),b[a][d].bind(h,function(){b[a][d]&&(b[a][d].unbind(h),b[a][d].attr("style","display:none;"),c.data(b[a][d],"used",0))}))}},t=function(){if(r){f=-1;for(var h=0;h<a.maxSprite;h++)if(!b[d][h]||!c.data(b[d][h],"used")){f=h;break}if(f>=0){s=p.getCssStart();e=p.getCssEnd(s);switch(a.effect){case "artifice":k=
-a.emitterCenterLeft;l=-a.emitterCenterTop;m=g-a.emitterCenterLeft-parseInt(e.width,10);n=j-a.emitterCenterTop-parseInt(e.height,10);Math.random()>0.5?(e.marginLeft=c.getRand(k,m),e.marginTop=Math.random()<0.5?l:n):(e.marginLeft=Math.random()<0.5?k:m,e.marginTop=c.getRand(l,n));break;case "nebula":k=-a.emitterCenterLeft-parseInt(e.width,10),l=-a.emitterCenterTop-parseInt(e.height,10),m=g-a.emitterCenterLeft,n=j-a.emitterCenterTop,Math.random()>0.5?(e.marginLeft=c.getRand(k,m),e.marginTop=Math.random()<
0.5?l:n):(e.marginLeft=Math.random()<0.5?k:m,e.marginTop=c.getRand(l,n))}if(!b[d][f]||b[d][f].length<1)b[d][f]=c(a.element).appendTo(i);c.data(b[d][f],"used",1);b[d][f].crossCss(s);i.trigger("emit",[b[d][f]]);setTimeout(p.applyCssEnd,0,d,f,e)}f=void 0;s=void 0;e=void 0;k=void 0;l=void 0;m=void 0;n=void 0;a.rate?o=setTimeout(t,a.rate):b.requestAnimFrame(t)}};i.bind(q);i.trigger("start");return i})};c.fn.emitter.options={effect:"nebula",transition:"all 1000ms linear",newAtTop:"random",emitterRadius:0,
emitterCenterLeft:null,emitterCenterTop:null,rate:null,maxSprite:30,element:"<div></div>",position:"absolute",display:"block",zIndex:500,cssFrom:{width:"10%",maxSize:null},cssTo:{}}})(jQuery,window);